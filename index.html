<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discord Auto Setup Tool</title>
  <style>
    /* CSS: å…ƒã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€
       å®Ÿéš›ã®å‹•ä½œã«å¿…è¦ãªãƒ­ã‚°ã‚¨ãƒªã‚¢ã¨ãƒœã‚¿ãƒ³ã®æ´»æ€§åŒ–ã‚’è¿½åŠ 
    */
    body { margin: 0; font-family: 'Helvetica Neue', Arial, sans-serif; background: #f2f4f7; color: #2c3e50; }
    .container { max-width: 500px; margin: 40px auto; background: #ffffff; padding: 30px; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); }
    h1 { text-align: center; margin-bottom: 10px; font-size: 24px; color: #5865F2; }
    .note { font-size: 12px; color: #d32f2f; background: #fff5f5; padding: 12px; border: 1px solid #ffcdd2; border-radius: 6px; margin-bottom: 20px; line-height: 1.5; }
    .section { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-size: 13px; font-weight: bold; }
    input[type="text"], input[type="password"] { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; box-sizing: border-box; transition: border-color 0.2s; }
    input:focus { outline: none; border-color: #5865F2; }
    .checkbox-group { background: #f8f9fa; padding: 15px; border-radius: 8px; }
    .checkbox { display: flex; align-items: center; margin-bottom: 10px; font-size: 14px; color: #444; }
    .checkbox input { margin-right: 12px; width: 16px; height: 16px; }
    .run-btn { width: 100%; padding: 15px; font-size: 16px; font-weight: bold; border: none; border-radius: 6px; background: #5865F2; color: #ffffff; cursor: pointer; transition: all 0.3s ease; }
    .run-btn:hover { background: #4752c4; }
    .run-btn:disabled { background: #999; cursor: not-allowed; }
    .log-container { margin-top: 25px; background: #1e1e1e; padding: 15px; border-radius: 8px; display: none; }
    .status-log { height: 140px; overflow-y: auto; color: #00ff00; font-family: monospace; font-size: 12px; line-height: 1.6; margin-bottom: 10px; }
    .progress-bar { height: 6px; background: #333; border-radius: 3px; overflow: hidden; }
    .progress { height: 100%; background: #00ff00; width: 0%; transition: width 0.4s ease; }
  </style>
</head>
<body>

<div class="container">
  <h1>Discord Auto Setup</h1>
  <p class="note">
    â€» <b>é‡è¦</b>: å®Ÿéš›ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚è¦ç´„é•åï¼ˆSelf-botï¼‰ã«ã‚ˆã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåœæ­¢ãƒªã‚¹ã‚¯ã‚’æ‰¿çŸ¥ã®ä¸Šã§åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚
  </p>

  <div class="section">
    <label>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒˆãƒ¼ã‚¯ãƒ³</label>
    <input type="password" id="token" placeholder="mfa.xxxx...">
  </div>

  <div class="section">
    <label>ã‚µãƒ¼ãƒãƒ¼ID</label>
    <input type="text" id="serverId" placeholder="123456789012345678">
  </div>

  <div class="section">
    <label>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸URL (ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ»èªè¨¼ç”¨)</label>
    <input type="text" id="messageUrl" placeholder="https://discord.com/channels/123/456/789">
  </div>

  <div class="section">
    <label>è‡ªå‹•ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š</label>
    <div class="checkbox-group">
      <div class="checkbox">
        <input type="checkbox" id="step1" checked> <span>âœ… ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ã§æŠ¼ã™</span>
      </div>
      <div class="checkbox">
        <input type="checkbox" id="step2" checked> <span>ğŸ’¬ èªè¨¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡</span>
      </div>
    </div>
  </div>

  <button id="runBtn" class="run-btn">ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Ÿè¡Œ</button>

  <div id="logContainer" class="log-container">
    <div id="statusLog" class="status-log"></div>
    <div class="progress-bar"><div id="progress" class="progress"></div></div>
  </div>
</div>

<script>
/* JavaScript: APIé€£æºãƒ­ã‚¸ãƒƒã‚¯ */
document.getElementById('runBtn').addEventListener('click', async function() {
    const token = document.getElementById('token').value.trim();
    const serverId = document.getElementById('serverId').value.trim();
    const msgUrl = document.getElementById('messageUrl').value.trim();
    
    const btn = this;
    const logArea = document.getElementById('statusLog');
    const logContainer = document.getElementById('logContainer');
    const progressBar = document.getElementById('progress');

    if (!token || !serverId || !msgUrl) {
        alert("ã™ã¹ã¦ã®é …ç›®ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
    }

    // URLã‹ã‚‰ChannelIDã¨MessageIDã‚’æŠ½å‡º
    const urlParts = msgUrl.split('/');
    const messageId = urlParts.pop();
    const channelId = urlParts.pop();

    // UIæ›´æ–°
    btn.disabled = true;
    btn.innerText = "å®Ÿè¡Œä¸­...";
    logContainer.style.display = 'block';
    logArea.innerHTML = "";
    progressBar.style.width = "0%";

    const addLog = (msg, isError = false) => {
        const div = document.createElement('div');
        div.style.color = isError ? "#ff4d4d" : "#00ff00";
        div.textContent = `> ${msg}`;
        logArea.appendChild(div);
        logArea.scrollTop = logArea.scrollHeight;
    };

    try {
        addLog(`ã‚µãƒ¼ãƒãƒ¼ (${serverId}) ã¸ã®æ¥ç¶šã‚’è©¦è¡Œä¸­...`);

        // STEP 1: ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³
        if (document.getElementById('step1').checked) {
            addLog("ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡...");
            const emoji = encodeURIComponent("âœ…");
            const res = await fetch(`https://discord.com/api/v9/channels/${channelId}/messages/${messageId}/reactions/${emoji}/@me`, {
                method: "PUT",
                headers: { "Authorization": token }
            });

            if (res.status === 204) addLog("æˆåŠŸ: ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Œäº†");
            else addLog(`å¤±æ•—: Code ${res.status}`, true);
            
            progressBar.style.width = "50%";
            await new Promise(r => setTimeout(r, 1200));
        }

        // STEP 2: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ (ã‚µãƒ¼ãƒãƒ¼IDã‚’æ–‡è„ˆã«å«ã‚ã‚‹ç­‰)
        if (document.getElementById('step2').checked) {
            addLog("èªè¨¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡...");
            const res = await fetch(`https://discord.com/api/v9/channels/${channelId}/messages`, {
                method: "POST",
                headers: {
                    "Authorization": token,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ content: "ãƒ«ãƒ¼ãƒ«ã«åŒæ„ã—ã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Œäº†ã—ã¾ã™ã€‚" })
            });

            if (res.ok) addLog("æˆåŠŸ: èªè¨¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡å®Œäº†");
            else addLog(`å¤±æ•—: Code ${res.status}`, true);
            
            progressBar.style.width = "100%";
        }

        addLog("ã™ã¹ã¦ã®å‡¦ç†ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚");
        btn.innerText = "å®Œäº†";
        btn.style.background = "#2ecc71";

    } catch (err) {
        addLog(`ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: ${err.message}`, true);
        btn.disabled = false;
        btn.innerText = "å†è©¦è¡Œ";
    }
});
</script>
</body>
</html>
